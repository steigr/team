require coreos

ssh_update() {
  ssh_stop
  ssh_install
}

ssh_install() {
  _ssh_write_unit
  ssh_start
}

ssh_stop() {
  coreos_stop sshd
}

ssh_start() {
  coreos_start sshd 
}

ssh_reload() {
  ssh_stop
  ssh_start
}

ssh_port() {
  echo "2220"
}

ssh_clean() {
  _coreos_remove_unit $(_coreos_unit socket sshd)
}

_ssh_write_unit() {
  _coreos_write_unit $(coreos_unit socket sshd) <<EO_SSH_SOCKET_UNIT
[Socket]
ListenStream=$(ssh_port)
Accept=yes
EO_SSH_SOCKET_UNIT
}