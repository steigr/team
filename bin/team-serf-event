#!/bin/bash

. $TEAM_LIB/dependency.lib
require team
require serf-event

[[ "x" = "x$SERF_EVENT" ]] && exit 0

echo "Got Payload $SERF_PAYLOAD" >> /tmp/serf-event.log

serf_event_handlers | while read handler; do
  SERF_EVENT_ENVIRONMENT=$(serf_event_environment)
  /bin/sh "TEAM=$TEAM TEAM_LIB=$TEAM_LIB $SERF_EVENT_ENVIRONMENT DEBUG=$DEBUG $handler $*"
done

exit 0