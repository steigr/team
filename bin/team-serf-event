#!/bin/sh

. $TEAM_LIB/team.lib
. $TEAM_LIB/serf-event.lib

[[ "x" = "x$SERF_EVENT" ]] && exit 0

serf_event_handlers | while read handler; do
  echo "Running $handler" >&2
  SERF_EVENT_ENVIRONMENT=$(serf_event_environment)
  /bin/sh -c "TEAM=\"$TEAM\" TEAM_LIB=\"$TEAM_LIB\" $SERF_EVENT_ENVIRONMENT /bin/sh $handler $*"
done
exit 0