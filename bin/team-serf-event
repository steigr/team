#!/bin/bash

. $TEAM_LIB/dependency.lib
require team
require serf-event

[[ "x" = "x$SERF_EVENT" ]] && exit 0

test "x$SERF_EVENT" = "xuser" && PAYLOAD=$(cat)

serf_event_handlers | while read handler; do
  SERF_EVENT=user \
  && echo $PAYLOAD | /bin/bash -i $handler $* \
  || /bin/bash -i $handler $*
done

exit 0