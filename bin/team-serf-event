#!/bin/bash

. $TEAM_LIB/dependency.lib
require team
require serf-event

[[ "x" = "x$SERF_EVENT" ]] && exit 0

test "x$SERF_EVENT" = "xuser" && PAYLOAD=$(cat)

serf_event_handlers | while read handler; do
  test "x$SERF_EVENT" = "xuser" \
  && echo $PAYLOAD | /bin/bash -i $handler $* 2>/dev/null \
  || /bin/bash -i $handler $* 2>/dev/null 
done

exit 0